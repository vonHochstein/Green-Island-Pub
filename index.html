<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Whiskydatenbank â€“ Green Island Pub (Demo)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <div class="brand">
        <div class="brand-mark">GI</div>
        <div class="brand-text">
          <h1>Green Island Pub Zeitz</h1>
          <p>Whiskydatenbank Â· Demo-Version</p>
        </div>
      </div>
      <div class="header-badge">Demo</div>
    </div>
  </header>

  <main class="wrapper">
    <!-- Auth-Leiste -->
    <div class="auth-bar">
      <div class="auth-info">
        <span id="authStatus"></span>

        <!-- Fortschritt in der Auth-Bar -->
        <div id="progressSection" class="auth-progress hidden">
          <p id="progressText" class="progress-text"></p>
          <div class="progress-bar-wrapper">
            <div id="progressBar" class="progress-bar"></div>
          </div>
        </div>
      </div>

      <div class="auth-actions">
        <button id="btnLogin">Anmelden</button>
        <button id="btnRegister">Registrieren</button>
        <button id="btnLogout" class="hidden">Abmelden</button>
      </div>
    </div>

    <!-- Filter / Suche / Sortierung -->
    <section class="filters">
      <input
        id="searchInput"
        type="text"
        placeholder="Suche nach Name, Destillerie, Stil, Land â€¦"
      />

      <div class="sort-controls">
        <select id="sortFieldSelect">
          <option value="name">Name</option>
          <option value="price">Preis</option>
          <option value="abv">StÃ¤rke (Vol.% )</option>
          <option value="rating_avg">Gesamtbewertung</option>
          <option value="rating_my" data-scope="my">Deine Bewertung</option>
        </select>

        <button
          id="sortDirToggle"
          class="sort-dir sort-dir-asc"
          type="button"
          aria-label="Aufsteigend sortieren"
        >
          â–²
        </button>

        <!-- ðŸŽ² Random-Button -->
        <button
          id="btnRandomWhisky"
          class="btn-random"
          type="button"
        >
          ðŸŽ² Ãœberrasch mich
        </button>
      </div>
    </section>

    <!-- Status + Grid -->
    <section id="status" class="status">
      Lade Whiskys â€¦
    </section>

    <section id="whiskyGrid" class="whisky-grid">
      <!-- Karten via JS -->
    </section>
  </main>

  <!-- Detail-Overlay fÃ¼r einzelnen Whisky -->
  <div id="detailOverlay" class="detail-overlay" aria-hidden="true">
    <div class="detail-backdrop" id="detailBackdrop"></div>

    <article class="detail-panel">
      <button class="detail-close" id="detailClose" aria-label="SchlieÃŸen">Ã—</button>

      <div class="detail-image-wrapper">
        <img id="detailImage" src="" alt="Whisky" />
      </div>

      <div class="detail-content">
        <h2 id="detailName"></h2>
        <p id="detailMeta" class="detail-meta"></p>

        <!-- Durchschnittsbewertung im Detail -->
        <p id="detailRatingSummary" class="detail-rating-summary"></p>

        <p id="detailPrice" class="detail-price"></p>
        <p id="detailDescription" class="detail-description"></p>

        <!-- Bewertungsbereich â€“ nur sichtbar, wenn angemeldet -->
        <div id="ratingSection" class="rating-section">
          <div id="ratingStars" class="rating-stars">
            <button type="button" data-value="1">â˜…</button>
            <button type="button" data-value="2">â˜…</button>
            <button type="button" data-value="3">â˜…</button>
            <button type="button" data-value="4">â˜…</button>
            <button type="button" data-value="5">â˜…</button>
          </div>

          <textarea
            id="ratingNote"
            class="rating-note"
            rows="3"
            placeholder="Deine persÃ¶nliche Notiz zu diesem Whisky â€¦"
          ></textarea>

          <button type="button" id="ratingSave" class="rating-save">
            Bewertung speichern
          </button>

          <p id="ratingHint" class="rating-hint">
            Gib deine persÃ¶nliche Bewertung ab.
          </p>
        </div>
      </div>
    </article>
  </div>

  <!-- ðŸŽ² Overlay fÃ¼r Zufalls-Whisky -->
  <div id="randomOverlay" class="detail-overlay" aria-hidden="true">
    <div class="detail-backdrop" id="randomBackdrop"></div>

    <article class="detail-panel random-panel">
      <button class="detail-close" id="randomClose" aria-label="SchlieÃŸen">Ã—</button>

      <h2>Zufalls-Whisky</h2>

      <div id="randomContent" class="random-content">
        <!-- Inhalt per JS -->
      </div>

      <div class="random-actions">
        <button type="button" id="btnRandomNext" class="rating-save">
          Noch ein Vorschlag
        </button>
        <button type="button" id="btnRandomClose" class="rating-save">
          SchlieÃŸen
        </button>
      </div>
    </article>
  </div>

  <!-- Auth-Overlay fÃ¼r Login / Registrierung -->
  <div id="authOverlay" class="auth-overlay" aria-hidden="true">
    <div class="detail-backdrop" id="authBackdrop"></div>

    <article class="auth-panel">
      <button class="detail-close" id="authClose" aria-label="SchlieÃŸen">Ã—</button>

      <h2 id="authTitle">Anmelden</h2>
      <p id="authHint" class="auth-hint">
        Melde dich mit deiner E-Mail und deinem Passwort an.
      </p>

      <form id="authForm" class="auth-form">
        <label class="auth-field auth-displayname-field">
          Anzeigename (nur bei Registrierung)
          <input id="authDisplayName" type="text" autocomplete="nickname" />
        </label>

        <label class="auth-field">
          E-Mail
          <input id="authEmail" type="email" autocomplete="email" required />
        </label>

        <label class="auth-field">
          Passwort
          <input id="authPassword" type="password" autocomplete="current-password" required />
        </label>

        <button type="submit" id="authSubmit" class="auth-submit">
          Anmelden
        </button>
      </form>

      <div class="auth-switch">
        <button type="button" id="switchToRegister" class="auth-link">
          Noch kein Konto? Registrieren
        </button>
        <button type="button" id="switchToLogin" class="auth-link hidden">
          Schon registriert? Anmelden
        </button>
      </div>

      <p class="auth-message" id="authMessage"></p>
    </article>
  </div>

  <!-- Supabase UMD Build -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script src="app.js"></script>
</body>
</html>